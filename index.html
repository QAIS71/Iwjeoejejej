<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Space Selfie AI - Real Human Interaction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Inter:wght@400;700;900&display=swap');
        body { background-color: #030305; color: white; overflow-x: hidden; transition: all 0.3s ease; }
        .rtl { font-family: 'Cairo', sans-serif; direction: rtl; }
        .ltr { font-family: 'Inter', sans-serif; direction: ltr; }
        .glass { background: rgba(10, 10, 15, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .loading-bar-inner { height: 100%; background: linear-gradient(90deg, #2563eb, #60a5fa); width: 0%; transition: width 0.1s linear; }
        .shimmer { background: linear-gradient(90deg, #111, #222, #111); background-size: 200% 100%; animation: shimmer 2s infinite; }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    </style>
</head>
<body class="ltr" id="appBody">

    <!-- Global Header -->
    <nav class="border-b border-white/5 bg-black/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <i data-lucide="rocket" class="text-blue-500 w-6 h-6"></i>
                <span class="font-black text-xl tracking-tight uppercase">SPACE<span class="text-blue-500">SELFIE</span></span>
            </div>
            
            <div class="flex items-center gap-3">
                <i data-lucide="languages" class="w-4 h-4 text-white/40"></i>
                <select id="langPicker" onchange="updateLanguage()" class="bg-white/5 text-[10px] rounded-full px-4 py-1.5 border border-white/10 outline-none cursor-pointer">
                    <option value="en">English (Default)</option>
                    <option value="ar">العربية</option>
                    <option value="zh">中文 (Chinese)</option>
                    <option value="ko">한국어 (Korean)</option>
                </select>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-6 py-8">
        <!-- Header Ad -->
        <div class="w-full h-24 bg-white/5 border border-white/5 rounded-2xl mb-8 flex items-center justify-center text-[10px] text-white/20 tracking-[1em] shimmer">
            LEADERBOARD AD SPACE
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
            <div class="lg:col-span-5 space-y-6">
                <div class="glass p-8 rounded-[40px] shadow-2xl relative overflow-hidden">
                    <h2 id="txt-title" class="text-3xl font-black mb-1">Realistic Space Selfie</h2>
                    <p id="txt-subtitle" class="text-white/40 text-sm mb-8">Real astronaut capturing you inside ISS</p>

                    <div onclick="document.getElementById('imgInput').click()" class="border-2 border-dashed border-white/10 rounded-3xl p-10 bg-white/[0.02] hover:bg-white/[0.04] transition-all cursor-pointer text-center group">
                        <input type="file" id="imgInput" class="hidden" accept="image/*" onchange="handleFile(event)">
                        <div id="upload-ui">
                            <i data-lucide="camera" class="w-12 h-12 text-blue-500 mx-auto mb-4 group-hover:scale-110 transition"></i>
                            <p id="txt-upload" class="font-bold text-white/50">Click to upload your portrait</p>
                        </div>
                        <div id="preview-ui" class="hidden">
                            <img id="imgPreview" src="" class="w-24 h-24 object-cover rounded-full border-4 border-blue-500 mx-auto">
                        </div>
                    </div>

                    <div class="mt-8">
                        <p id="txt-region-lbl" class="text-[10px] font-black uppercase tracking-widest text-white/30 mb-4 text-center">Preferred Orbit Location</p>
                        <div id="regionGrid" class="grid grid-cols-3 gap-2"></div>
                    </div>

                    <button id="genBtn" onclick="startGeneration()" class="w-full mt-10 py-5 bg-blue-600 rounded-2xl font-black text-xl hover:bg-blue-500 transition shadow-xl flex items-center justify-center gap-3">
                        <i data-lucide="zap"></i>
                        <span id="txt-btn">Launch Now</span>
                    </button>
                </div>
            </div>

            <div class="lg:col-span-7">
                <div id="displayFrame" class="bg-[#0a0a0f] border border-white/10 rounded-[50px] aspect-square relative overflow-hidden shadow-2xl flex items-center justify-center">
                    <div id="loadingOverlay" class="hidden absolute inset-0 bg-[#050508]/95 z-30 flex flex-col items-center justify-center p-12 text-center">
                        <div class="w-full max-w-sm">
                            <div class="h-1.5 w-full bg-white/5 rounded-full mb-6 overflow-hidden">
                                <div id="pBar" class="loading-bar-inner"></div>
                            </div>
                            <h3 id="loadingText" class="text-2xl font-black mb-2 italic">Transmitting data to orbit...</h3>
                            <p class="text-blue-400 text-xs font-bold" id="timerCount">20s Remaining</p>
                        </div>
                    </div>

                    <div id="emptyView" class="text-center opacity-10">
                        <i data-lucide="milestone" class="w-24 h-24 mx-auto mb-4"></i>
                        <p class="text-[10px] font-black tracking-[1em] uppercase">No Signal</p>
                    </div>

                    <div id="resultView" class="hidden w-full h-full relative group">
                        <img id="finalImg" src="" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black p-10 flex flex-col justify-end opacity-0 group-hover:opacity-100 transition-all">
                            <button onclick="downloadImage()" class="w-full py-5 bg-white text-black font-black rounded-2xl flex items-center justify-center gap-3">
                                <i data-lucide="download"></i> <span id="txt-dl">Download 8K Image</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // مفتاحك المضاف بنجاح
        const API_KEY = "AIzaSyCnS1MV_PFoGjNmTIb3hi3yjkk7mjtINYQ"; 
        
        let currentLang = 'en';
        let currentRegion = 0;
        let userImageBase64 = null;

        const languages = {
            en: { title: "Realistic Space Selfie", sub: "Real astronaut capturing you inside ISS", upload: "Click to upload your portrait", btn: "Launch Now", regions: ["Middle East", "Europe", "Africa", "Asia", "Americas"], dl: "Download 8K Image", loading: ["Analyzing face...", "Preparing suit...", "Adjusting light...", "Final shot..."], transmission: "Transmitting data to orbit...", remaining: "Remaining" },
            ar: { title: "سيلفي الفضاء الواقعي", sub: "رائد فضاء حقيقي يصورك داخل محطة ISS", upload: "اضغط لرفع صورتك الشخصية", btn: "إقلاع الآن", regions: ["الشرق الأوسط", "أوروبا", "أفريقيا", "آسيا", "الأمريكتين"], dl: "تحميل الصورة 8K", loading: ["تحليل الوجه...", "تجهيز البدلة...", "ضبط الإضاءة...", "التقاط الصورة..."], transmission: "جاري إرسال البيانات...", remaining: "متبقي" }
        };

        function updateLanguage() {
            currentLang = document.getElementById('langPicker').value;
            const t = languages[currentLang] || languages['en'];
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-subtitle').innerText = t.sub;
            document.getElementById('txt-upload').innerText = t.upload;
            document.getElementById('txt-btn').innerText = t.btn;
            document.getElementById('txt-dl').innerText = t.dl;
            document.getElementById('appBody').className = (currentLang === 'ar') ? 'rtl' : 'ltr';
            renderRegions();
        }

        function renderRegions() {
            const t = languages[currentLang] || languages['en'];
            const grid = document.getElementById('regionGrid');
            grid.innerHTML = '';
            t.regions.forEach((name, i) => {
                const b = document.createElement('button');
                b.className = `py-2 rounded-xl text-[10px] font-bold border ${currentRegion === i ? 'bg-blue-600 border-blue-400' : 'bg-white/5 border-white/10 text-white/40'}`;
                b.innerText = name;
                b.onclick = () => { currentRegion = i; renderRegions(); };
                grid.appendChild(b);
            });
        }

        function handleFile(e) {
            const file = e.target.files[0];
            if(file) {
                const reader = new FileReader();
                reader.onload = (ev) => {
                    document.getElementById('imgPreview').src = ev.target.result;
                    document.getElementById('preview-ui').classList.remove('hidden');
                    document.getElementById('upload-ui').classList.add('hidden');
                    userImageBase64 = ev.target.result.split(',')[1];
                };
                reader.readAsDataURL(file);
            }
        }

        async function startGeneration() {
            if(!userImageBase64) return alert("Upload photo first!");
            const overlay = document.getElementById('loadingOverlay');
            overlay.classList.remove('hidden');
            let timeLeft = 20;
            let progress = 0;
            const interval = setInterval(() => {
                timeLeft -= 0.1; progress += 0.5;
                document.getElementById('pBar').style.width = `${progress}%`;
                document.getElementById('timerCount').innerText = `${Math.ceil(timeLeft)}s ${languages[currentLang].remaining}`;
                if(timeLeft <= 0) { clearInterval(interval); executeAI(); }
            }, 100);
        }

        async function executeAI() {
            const region = languages[currentLang].regions[currentRegion];
            const prompt = `A hyper-realistic 8K photograph inside the ISS Cupola. A real astronaut in a white spacesuit is holding up a high-quality photo print showing the face from this image. The astronaut's gloved hand is clearly visible and holding the picture. Breathtaking Earth view over ${region} through the windows. Cinematic lighting, professional photography.`;
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }, { inlineData: { mimeType: "image/png", data: userImageBase64 } }] }],
                        generationConfig: { responseModalities: ['TEXT', 'IMAGE'] }
                    })
                });
                const data = await response.json();
                const img = data.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;
                if(img) {
                    document.getElementById('finalImg').src = `data:image/png;base64,${img}`;
                    document.getElementById('resultView').classList.remove('hidden');
                    document.getElementById('emptyView').classList.add('hidden');
                }
            } catch(e) { console.error(e); } finally { document.getElementById('loadingOverlay').classList.add('hidden'); }
        }

        function downloadImage() {
            const a = document.createElement('a');
            a.href = document.getElementById('finalImg').src;
            a.download = 'SpaceSelfie.png';
            a.click();
        }

        updateLanguage();
        lucide.createIcons();
    </script>
</body>
</html>

